{{ 'custom-sections.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign section_width = section.settings.section_width | default: 'full-width'
  assign content_width = section.settings.content_width | default: 50
  assign overlay_opacity = section.settings.overlay_opacity | default: 0
  assign min_height = section.settings.min_height | default: 500
  assign min_height_mobile = section.settings.min_height_mobile | default: 400
-%}

<style>
  #CustomHero-{{ section.id }} {
    --ch-min-height: {{ min_height }}px;
    --ch-min-height-mobile: {{ min_height_mobile }}px;
    --ch-content-width: {{ content_width }}%;
    --ch-overlay-opacity: {{ overlay_opacity | divided_by: 100.0 }};
  }
</style>

<div class="section-background color-{{ section.settings.color_scheme }}"></div>

<section
  id="CustomHero-{{ section.id }}"
  class="ch section section--{{ section_width }} color-{{ section.settings.color_scheme }} spacing-style"
  style="{% render 'spacing-padding', settings: section.settings %}"
  data-section-id="{{ section.id }}"
  data-section-type="custom-hero"
>
  <div class="ch__media">
    {%- if section.settings.image != blank -%}
      <img
        class="ch__image"
        src="{{ section.settings.image | image_url: width: 1920 }}"
        alt="{{ section.settings.image.alt | escape }}"
        width="{{ section.settings.image.width }}"
        height="{{ section.settings.image.height }}"
        loading="eager"
        fetchpriority="high"
        sizes="100vw"
        srcset="
          {{ section.settings.image | image_url: width: 600 }} 600w,
          {{ section.settings.image | image_url: width: 900 }} 900w,
          {{ section.settings.image | image_url: width: 1200 }} 1200w,
          {{ section.settings.image | image_url: width: 1920 }} 1920w
        "
      >
      {%- if section.settings.image_mobile != blank -%}
        <img
          class="ch__image ch__image--mobile"
          src="{{ section.settings.image_mobile | image_url: width: 800 }}"
          alt="{{ section.settings.image_mobile.alt | escape }}"
          width="{{ section.settings.image_mobile.width }}"
          height="{{ section.settings.image_mobile.height }}"
          loading="eager"
          fetchpriority="high"
          sizes="100vw"
        >
      {%- endif -%}
    {%- else -%}
      {{ 'lifestyle-1' | placeholder_svg_tag: 'ch__image ch__placeholder' }}
    {%- endif -%}

    {%- if overlay_opacity > 0 -%}
      <div class="ch__overlay" aria-hidden="true"></div>
    {%- endif -%}
  </div>

  {%- if section.blocks.size > 0 -%}
    {%- assign all_positions = 'top-left,top-center,top-right,center-left,center,center-right,bottom-left,bottom-center,bottom-right' | split: ',' -%}

    {%- for position in all_positions -%}
      {%- assign has_blocks = false -%}
      {%- for block in section.blocks -%}
        {%- assign block_pos = block.settings.content_position | default: 'bottom-left' -%}
        {%- if block_pos == position -%}
          {%- assign has_blocks = true -%}
        {%- endif -%}
      {%- endfor -%}

      {%- if has_blocks -%}
        <div class="ch__content ch__content--{{ position }}">
          <div class="ch__content-inner">
            {%- for block in section.blocks -%}
              {%- assign block_pos = block.settings.content_position | default: 'bottom-left' -%}
              {%- if block_pos == position -%}
                {%- assign block_mobile_pos = block.settings.content_position_mobile | default: block_pos -%}
                {%- case block.type -%}

                  {%- when 'caption' -%}
                    {%- if block.settings.text != blank -%}
                      <p class="ch__subtitle ch__block-mobile--{{ block_mobile_pos }}" {{ block.shopify_attributes }}>{{ block.settings.text }}</p>
                    {%- endif -%}

                  {%- when 'heading' -%}
                    {%- if block.settings.text != blank -%}
                      <h2 class="ch__heading ch__block-mobile--{{ block_mobile_pos }}" {{ block.shopify_attributes }}>{{ block.settings.text }}</h2>
                    {%- endif -%}

                  {%- when 'description' -%}
                    {%- if block.settings.text != blank -%}
                      <p class="ch__description ch__block-mobile--{{ block_mobile_pos }}" {{ block.shopify_attributes }}>{{ block.settings.text }}</p>
                    {%- endif -%}

                  {%- when 'button' -%}
                    {%- if block.settings.label != blank -%}
                      {%- assign btn_style = block.settings.style | default: 'primary' -%}
                      <a
                        href="{{ block.settings.link }}"
                        class="ch__btn ch__btn--{{ btn_style }} ch__block-mobile--{{ block_mobile_pos }}"
                        aria-label="{{ block.settings.label | escape }}"
                        {{ block.shopify_attributes }}
                      >
                        <span>{{ block.settings.label }}</span>
                        <span class="ch__btn-arrow" aria-hidden="true">&rarr;</span>
                      </a>
                    {%- endif -%}

                {%- endcase -%}
              {%- endif -%}
            {%- endfor -%}
          </div>
        </div>
      {%- endif -%}
    {%- endfor -%}
  {%- endif -%}
</section>

{% schema %}
{
  "name": "Custom Hero",
  "tag": "section",
  "class": "custom-hero-section",
  "settings": [
    {
      "type": "header",
      "content": "t:content.layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.section_width",
      "options": [
        {
          "value": "page-width",
          "label": "t:options.page"
        },
        {
          "value": "full-width",
          "label": "t:options.full"
        }
      ],
      "default": "full-width"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "min_height",
      "label": "t:settings.minimum_height",
      "min": 200,
      "max": 900,
      "step": 10,
      "unit": "px",
      "default": 500
    },
    {
      "type": "range",
      "id": "min_height_mobile",
      "label": "t:settings.mobile_height",
      "min": 200,
      "max": 700,
      "step": 10,
      "unit": "px",
      "default": 400
    },
    {
      "type": "range",
      "id": "content_width",
      "label": "t:settings.content_width",
      "min": 30,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 50
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "t:content.media"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:settings.image"
    },
    {
      "type": "image_picker",
      "id": "image_mobile",
      "label": "t:settings.mobile_logo_image",
      "info": "Optional mobile-specific image."
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "t:settings.overlay_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "caption",
      "name": "t:names.caption",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "t:settings.text"
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "t:settings.content_position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "content_position_mobile",
          "label": "Mobile content position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        }
      ]
    },
    {
      "type": "heading",
      "name": "t:names.heading",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "t:settings.heading",
          "default": "The Gift Guide"
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "t:settings.content_position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "content_position_mobile",
          "label": "Mobile content position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        }
      ]
    },
    {
      "type": "description",
      "name": "t:names.description",
      "settings": [
        {
          "type": "textarea",
          "id": "text",
          "label": "t:names.description",
          "default": "Discover Joy: Your Ultimate Holiday Gift Destination. Explore our curated selection and find the perfect gifts to delight your loved ones this holiday season."
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "t:settings.content_position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "content_position_mobile",
          "label": "Mobile content position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        }
      ]
    },
    {
      "type": "button",
      "name": "t:names.button",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "t:settings.label",
          "default": "SHOP NOW"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:settings.link"
        },
        {
          "type": "select",
          "id": "style",
          "label": "t:settings.display",
          "options": [
            { "value": "primary", "label": "t:options.button_primary" },
            { "value": "secondary", "label": "t:options.button_secondary" }
          ],
          "default": "primary"
        },
        {
          "type": "select",
          "id": "content_position",
          "label": "t:settings.content_position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        },
        {
          "type": "select",
          "id": "content_position_mobile",
          "label": "Mobile content position",
          "options": [
            { "value": "top-left", "label": "t:options.top_left" },
            { "value": "top-center", "label": "t:options.top_center" },
            { "value": "top-right", "label": "t:options.top_right" },
            { "value": "center-left", "label": "t:options.center_left" },
            { "value": "center", "label": "t:options.center" },
            { "value": "center-right", "label": "t:options.center_right" },
            { "value": "bottom-left", "label": "t:options.bottom_left" },
            { "value": "bottom-center", "label": "t:options.bottom_center" },
            { "value": "bottom-right", "label": "t:options.bottom_right" }
          ],
          "default": "bottom-left"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Hero",
      "blocks": [
        { "type": "caption" },
        { "type": "heading" },
        { "type": "description" },
        { "type": "button" }
      ]
    }
  ]
}
{% endschema %}
